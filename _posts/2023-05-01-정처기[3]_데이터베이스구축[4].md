---
layout: post
title: 정처기[3]_데이터베이스구축[4]
---

## 정처기_데이터베이스 구축 요약[4]

### SQL 활용

#### 프로시저(Procedure)

1. __프로시저(Procedure)의 개념__
    - 절차형 SQL을 활용하여 특정 기능을 수행하는 일종의 트랜잭션 언어
    - 호출을 통해 실행되어 미리 저장해 놓은 SQL 작업을 수행
    - 데이터베이스에 저장되어 수행 = 스토어드 프로시저
    - 시스템의 일일 마감 작업, 일괄 작업 등에 주로 사용
    - 구성도
        - DECLARE : 프로시저의 명칭, 변수, 인수, 데이터 타입을 정의 / 선언부
        - BEGIN  : 시작 / 실행부
        - CONTROL : 조건문 또는 반복문이 삽입되어 순차적으로 처리
        - SQL : DML, DCL이 사입되어 데이터관리를 위한 작업 수행
        - EXCEPTION : 예외 발생 시 처리하는 방법 정의
        - TRANSACTION : 수행된 데이터 작업들을 DB에 저장할지 취소할지를 결정
        - END : 종료 (Begin / End 는 함께 다님)
    - 프로시저 생성
        - CREATE PROCEDURE 명령어 사용
        ```
        CREATE [OR REPLACE] PROCEDURE 프로시저명(파라미터)[지역변수 선언]
        BEGIN
            프로시저 BODY;
        END;
        ```
        - OR REPLACE : 선택적인 예약어, 동일한 프로시저 이름이 이미 존재하는 경우 기존의 프로시저를 대체
        - 프로시저명 : 생성하려는 프로시저의 이름을 지정
        - 파라미터
        - 프로시저 BODY : 프로지서의 코드 기록
    - 프로시저 실행
        - EXECUTE 프로시저명; / EXEC 프로시저명; / CALL 프로시저명; 
    - 프로시저 제거
        - EROP PROCEDURE 프로시저명; 


#### 트리거

1. __트리거(Trigger)의 개요__
    - DB 시스템에서 Insert, Update, Delete 등의 이벤트가 발생할 때마다 관련 작업이 자동으로 수행되는 절차형 SQL
    - 데이터베이스에 저장되며, 데이터 변경 및 무결성 유지, 로그 메시지 출력 등의 목적으로 사용
    - DCL 사용 불가, DCL이 포함된 프로시저나 함수를 호출하는 경우 오류 발생
    - 오류가 있는 경우 데이터에도 영향을 끼친다.
    - 구성도
        - DECLARE : 트리거의 명칭, 변수 및 상수, 데이터 타입을 정의 / 선언부
        - EVENT : 실행되는 조건 명시
        - BEGIN  : 시작 / 실행부
        - CONTROL : 조건문 또는 반복문이 삽입되어 순차적으로 처리
        - SQL : DML문이 사입되어 데이터관리를 위한 작업 수행
        - EXCEPTION : 예외 발생 시 처리하는 방법 정의
        - END : 종료 (Begin / End 는 함께 다님)
    - 트리거의 생성
        - CREATE TRIGGER 명령어 사용
        ```
        CREATE [OR REPLACE] TRIGGER 트리거명 동작시기 동작 ON 테이블명
        REFFERENCEING [NEW | OLD AS 테이블명]
        [FOR EACH ROW [WHEN 조건식]]
        BEGIN
            트리거 BODY;
        END;
        ```
        - OR REPLACE : 동일한 트리거 이름이 이미 존재하는 경우, 기존의 트리거 대체
        - 동작시기 : 트리거가 실행될때 (AFTER or BEFORE)    
        - 동작 : 작업의 종류
        - NEW | OLD : 트리거가 적용될 테이블의 별칭 지정(NEW : 추가되거나 수정에 참여할 테이블, OLD : 수정되거나 삭제 전 대상이 되는 테이블)
        - FOR EACH ROW : 각 튜플마다 트리거 적용
        - WHEN 조건식 : 트리거를 적용할 튜플의 조건
        - 트리거 BODY : 트리거의 본문 코드(적어도 하나 이상의 SQL문이 있어야 한다)
    - 트리거 제거
        - DROP TRIGGER 트리거명; 

#### 사용자 정의 함수

1. __사용자 정의 함수의 개요__
    - 프로시저와 유사하게 SQL을 사용하여 일련의 작업을 연속적으로 처리하며 종료 시 처리 결과를 단일값으로 반환하는 절차형 SQL
    - 데이터베이스에 저장되어 DML문의 호출에 의해 실행
    - 예약어 RETURN을 통해 결과값 반환
    - SELECT를 통한 조회만 가능
    - 프로시저 호출 불가
    - 구성도
        - DECLARE : 사용자 정의 함수 명칭, 변수 , 타입, 인수, 데이터 타입을 정의 / 선언부
        - BEGIN  : 시작 / 실행부
        - CONTROL : 조건문 또는 반복문이 삽입되어 순차적으로 처리
        - SQL : SELECT문이 사입되어 데이터관리를 위한 작업 수행
        - EXCEPTION : 예외 발생 시 처리하는 방법 정의
        - RETURN : 호출 프로그램에 반환할 값이나 변수 정의
        - END : 종료 (Begin / End 는 함께 다님) 
    - 함수 생성
        ```
        CREATE [OR REPLACE] FUNCTION 사용자 정의 함수명(파라미터)
        지역변수 선언
        BEGIN
            사용자 정의 함수 BODY;
            RETURN 반환값;
        END;
        ```
        - OR REPLACE : 동일한 이름이 존재할 경우 기존의 함수를 대체
        - 파라미터 : 
        - 사용자 정의 함수 BODY : 함수의 코드 기록, BEGIN과 END 사이에 적어도 하나의 SQL문이 있어야 한다.
        - RETURN 반환값 : 반환할 값이나 변수를 호출 프로그램으로 
    - 사용자 정의 함수 실행
        ```sql
        SELECT 사용자 정의 함수명 FROM 테이블명;
        INSERT INTO 테이블명(속성명) VALUES(사용자 정의 함수명);
        DELETE FROM 테이블명 WHERE 속성명 = 사용자 정의 함수명;
        UPDATE 테이블명 SET 속성명 = 사용자 정의 함수명;
        ```
    - 사용자 정의 함수 제거
        - DROP FUNCTION 사용자 정의 함수명;

#### DBMS 접속 기술

1. __DBMS 접속의 개요__
    - 사용자가 데이터를 사용하기 위해 응용 시스템을 이용하여 DBMS에 접근하는 것 



















